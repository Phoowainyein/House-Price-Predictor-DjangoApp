<!DOCTYPE html>
<html>
<head>
	<title>Apartment4u</title>
	<style>
		body {
			font-family: Arial, sans-serif;
            background-color: #1c1c27;
		}
       
		h1 {
			margin-top: 50px;
			text-align: center;
            color :#05c270;
		}
        
		/* nav bar  */
		#navbar {
        background-color: #28293d;
        overflow: hidden;
		
      }
      #navbar a {
        float: left;
        color: #05c270;
        text-align: center;
        padding: 14px 16px;
        text-decoration: none;
        font-size: 17px;
      }
      #navbar a:hover {
        /* background-color: #ddd; */
         color:#8ff794;
      }
      .active {
        /* background-color: #4CAF50; */
		border: 1px solid #4CAF50;
		border-radius: 8px;
		
		transition: background-color 3s ease-in-out;

      }
      .hori-selector {
        /* height: 3px;
        width: unset; */
        position: absolute;
        /* top: 50px; */
        left: 0;
        background-color: rgb(126, 196, 107);
        transition: all 0.3s ease-out;
      }
      #navbar a:hover .hori-selector,
      #navbar .active .hori-selector {
        width: 100%;
        left: 0;
        transition: all 0.3s ease-out;
      }

      .company-name {
		position: absolute;
		top: 20px;
		right: 20px;
		font-weight: bold;
		font-size: 1.2em;
		color: rgba(255, 255, 255, 0.777);
		
		}
    .select {
    width: 100%;
    height: 200px;
    border: 1px solid #28293d;
    overflow-y: auto;
    padding: 5px;
}
	
.success-message {
  display: none;
  background-color: #28293d;
  color: #05c270;
  font-weight: bold;
  padding: 10px;
  margin: 20px;
  text-align: center;
}

.button{
    background-color: #0d8907;
    color: #ffffff;
    border: none;
    padding: 10px 20px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    cursor: pointer;
    border-radius: 4px;
}

.button:hover {
    background-color: #1cd312;
}
    
</style>
</head>
<body>
    
	<!-- nav bar  -->
	<div id="navbar">
		<a href="{% url 'home' %}"  onclick="highlightNav(this)">File Upload<div class="hori-selector"></div></a>
		<a href="{% url 'train' %}" class="active" onclick="highlightNav(this)">Training<div class="hori-selector"></div></a>
		
		<a href="#" onclick="highlightNav(this)">Predict<div class="hori-selector"></div></a>
		<div class="company-name">Apartment 4 U</div>
	  </div>

    <h1>Select Columns for Training</h1>
    <select class="select" id="header-select" multiple>
    {% for header in headers %}
      <option value="{{ header }}">{{ header }}</option>
    {% endfor %}
   </select>

    <button class="button" id="train-button">Train</button>

    <div class="success-message" id="success-message">Training completed!</div>
    <button class="button" id="predict-button" style="display:none;">Predict</button>

    <script>
      const headerSelect = document.getElementById('header-select');
      const trainButton = document.getElementById('train-button');

      const successMessage = document.getElementById('success-message');
      const predictButton = document.getElementById('predict-button');

      trainButton.addEventListener('click', function() {
          const selectedOptions = Array.from(headerSelect.selectedOptions).map(option => option.value);
          console.log('Selected Headers:', selectedOptions);
          // Perform the training with the selected headers
           // Send the selected headers to the server using an AJAX request
    fetch('/train_model/', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': document.querySelector('input[name="csrfmiddlewaretoken"]').value
      },
      body: JSON.stringify({ 'selected_headers': selectedOptions })
    })
    .then(response => response.json())
    .then(data => {
      // Handle the response from the server
      console.log(data.message);
      console.log('Mean Squared Error:', data.mse);
      successMessage.style.display = 'block';
      predictButton.style.display = 'inline-block';
    });
    predictButton.addEventListener('click', function() {
  window.location.href = 'predict.html'; // Replace '/predict/' with the URL to your predict view
});
    

    

          // You can use AJAX or redirect the user to another view with the selected headers as parameters
      });

      

  </script>

<form style="display:none;">
  {% csrf_token %}
</form>   
	

        
	
</body>
</html>
