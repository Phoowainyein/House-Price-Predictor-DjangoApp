<!DOCTYPE html>
<html>
<head>
	<title>Apartment4u</title>
	<style>

		
		body {
			font-family: Arial, sans-serif;
            background-color:#1c1c27;
		}
        
            
		h1 {
			margin-top: 50px;
			text-align: center;
            color: #05c270;
		}
        /* intro text section */
        .intro {
            background-color: #1c1c27;
            border: 1px solid #1e1e2a;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            }


        .intro p {
        font-size: 1.2rem;
        color: rgba(255, 255, 255, 0.777);
        }

		/* nav bar  */
		#navbar {
        background-color: #28293d;
        overflow: hidden;
		
      }
      #navbar a {
        float: left;
        color: #05c270;
        text-align: center;
        padding: 14px 16px;
        text-decoration: none;
        font-size: 17px;
      }
      #navbar a:hover {
        /* background-color: #ddd; */
        color:#8ff794;
      }
      .active {
        /* background-color: #4CAF50; */
		border: 1px solid #4CAF50;
		border-radius: 8px;
		
		transition: background-color 3s ease-in-out;

      }
      .hori-selector {
        /* height: 3px;
        width: unset; */
        position: absolute;
        /* top: 50px; */
        left: 0;
        background-color:#0d8907;
        transition: all 5s ease-out;
      }
      #navbar a:hover .hori-selector,
      #navbar .active .hori-selector {
        width: 100%;
        left: 0;
        transition: all 5s ease-out;
      }

	  .company-name {
		position: absolute;
		top: 20px;
		right: 20px;
		font-weight: bold;
		font-size: 1.2em;
		color:rgba(255, 255, 255, 0.777);
		
		}


		
		form {
			margin-top: 50px;
			text-align: center;
		}
		input[type="file"] {
			display: none;
		}
		label {
			display: inline-block;
			padding: 10px 20px;
			background-color: #0d8907;
			color: #fff;
			border-radius: 5px;
			cursor: pointer;
		}
		label:hover {
			background-color: #1cd312;
		}

        /* form div styling */
        
.frame {
	position: absolute;
	top: 50%;
	left: 50%;
	width: 400px;
	height: 400px;
	margin-top: -200px;
	margin-left: -200px;
	border: 1px solid #4CAF50;
	border-radius: 8px;
	
	box-shadow: 4px 8px 16px 0 rgba(156, 233, 181, 0.1);
	overflow: hidden;
	background: #28293d;
	color: #333;
	font-family: "Open Sans", Helvetica, sans-serif;
}

.center {
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	width: 300px;
	height: 260px;

	border-radius: 8px; 
	
	box-shadow: 8px 10px 15px 0 rgba(0, 0, 0, 0.2);
	background: #1c1c27;
	display: flex;
	align-items: center;
	justify-content: space-evenly;
	flex-direction: column;
}

.title {
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  text-align: center;
  height: 100%;
}
.title p {
  font-family: "Open Sans", sans-serif;
  font-size: 28px;
  color: #05c270;
  margin: 0;
}

.hidden {
    display: none;
}
	</style>
</head>
<body>
   
	<!-- nav bar  -->
	<div id="navbar">
		<a href="{% url 'home' %}" class="active" onclick="highlightNav(this)">File Upload<div class="hori-selector"></div></a>
		<a href="{% url 'train' %}" onclick="highlightNav(this)">Training<div class="hori-selector"></div></a>
		<a href="#" onclick="highlightNav(this)">Predict<div class="hori-selector"></div></a>
		<div class="company-name">Apartment 4 U</div>
	  </div>

   <div class="intro">
    <p>
    House Price Prediction web application utilizes a  Linear Regression  model to accurately predict the price of a house.
    <br> You can get started by uploading a CSV file below!
    </p>
  </div>
  
	
<div class="frame">
    <div class="center">
        <div class="title">
        <p>Upload your file</p>
	    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <label for="file-upload">Select CSV file</label>
        <input type="file" id="file-upload" name="csv_file" accept=".csv">
        <input type="submit" value="Submit">
        </form>
        </div>
    </div>
</div>

	<script>
		document.getElementById("file-upload").addEventListener("change", function() {
			// Code to execute when a file is selected
			// For this case , will hide the button:
			const selectFileButton = document.querySelector("label[for='file-upload']");
    selectFileButton.classList.add("hidden");
	  // Change the "Upload your file" text to "Submit your file" when a file is selected
	  const uploadText = document.querySelector(".title p");
            uploadText.textContent = "Submit your file !";

	// Change the submit button's background color and size when a file is selected
		 const submitButton = document.querySelector("input[type='submit']");
    submitButton.style.backgroundColor = "#0d8907";
    submitButton.style.fontSize = "1.2em";
    submitButton.style.padding = "12px 24px";
            
		});
        document.querySelector('form').addEventListener('submit', function(e) {
		e.preventDefault(); // prevent the form from submitting normally

		const fileInput = document.querySelector('#file-upload');
    	const file = fileInput.files[0];
    	const allowedExtensions = /(\.csv)$/i; // regular expression to match CSV files
    	if (!allowedExtensions.exec(file.name)) {
        alert('Please select a CSV file.');
        fileInput.value = '';
        return false;
    }
		
		// create a FormData object to send the file with the form data
		const formData = new FormData();
		formData.append('csv_file', document.querySelector('#file-upload').files[0]);
		
		// send the form data to the server using an AJAX request
		fetch('/upload_csv/', {
			method: 'POST',
			body: formData,
			headers: {
				'X-CSRFToken': document.querySelector('input[name="csrfmiddlewaretoken"]').value
			}
		}).then(response => {
			if (response.ok) {
				// redirect to the secondpage.html page if the upload was successful
				window.location.href = "train.html";
			} else {
				alert('Upload failed.');
			}
		});
    });
	function highlightNav(element) {
        var navLinks = document.querySelectorAll("#navbar a");
        navLinks.forEach(function(link) {
            link.classList.remove("active");
        });
        element.classList.add("active");
    }
	
	




        
	</script>
</body>
</html>
